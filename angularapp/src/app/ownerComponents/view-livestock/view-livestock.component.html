<div class="viewLivestock container-fluid min-vh-100 d-flex flex-column p-3">
    <div class="container-fluid shadow-lg rounded py-3 min-vh-100">
        <p class="display-6 text-center my-3 bricolage-grotesque-Font">Livestocks</p>

        <div class="container-fluid py-4">
            <div class="mb-3">
                <input type="text" class="form-control bricolage-grotesque-Font" placeholder="Search by livestock name..."
                    (input)="searchBy($event)">
            </div>

            <div class="table-responsive rounded">
                <table class="table table-hover shadow">
                    <thead class="libertinus-sans-bold">
                        <tr>
                            <th class="th-bgColor text-center">S No</th>
                            <th class="th-bgColor text-center">Name</th>
                            <th class="th-bgColor text-center">Species</th>
                            <th class="th-bgColor text-center">Age</th>
                            <th class="th-bgColor text-center">Breed</th>
                            <th class="th-bgColor text-center">Health Condition</th>
                            <th class="th-bgColor text-center">Location</th>
                            <th class="th-bgColor text-center">Vaccination Status</th>
                            <th class="th-bgColor text-center">Action</th>
                        </tr>
                    </thead>

                    <tbody *ngIf="filteredliveStock.length > 0 && !loading" class="libertinus-sans-regular">
                        <tr *ngFor="let item of paginatedliveStock; let i=index">
                            <td class="pt-4 text-center">{{ (currentPage - 1) * itemsPerPage + i + 1 }}</td>
                            <td class="pt-4 text-center">{{ item.name }}</td>
                            <td class="pt-4 text-center">{{ item.species }}</td>
                            <td class="pt-4 text-center">{{ item.age }}</td>
                            <td class="pt-4 text-center">{{ item.breed }}</td>
                            <td class="pt-4 text-center">{{ item.healthCondition }}</td>
                            <td class="pt-4 text-center">{{ item.location }}</td>
                            <td class="pt-4 text-center">{{ item.vaccinationStatus }}</td>
                            <td class="d-flex justify-content-center">
                                <button class="ac-btn" mat-fab style="background-color: #61c1a5;"
                                    (click)="openLivestockDetail(item)"><mat-icon>visibility</mat-icon></button>
                                <button class="ac-btn" mat-fab color="accent" (click)="editLivestock(item._id)">
                                    <mat-icon>edit</mat-icon></button>
                                <button class="ac-btn" mat-fab color="warn"
                                    (click)="deleteLivestock(item._id)"><mat-icon
                                        class="m-auto">delete</mat-icon></button>
                            </td>
                        </tr>
                    </tbody>

                    <ng-container *ngIf="loading && !showEmptyMessage">
                        <tbody>
                            <tr>
                                <td colspan="9" class="text-center align-middle">
                                    <div class="d-flex justify-content-center align-items-center"
                                        style="height: 150px;">
                                        <mat-progress-spinner mode="indeterminate" diameter="40"
                                            color="primary"></mat-progress-spinner>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </ng-container>

                    <ng-container *ngIf="showEmptyMessage && !loading">
                        <tbody>
                            <tr>
                                <td colspan="9" class="text-center">
                                    No Livestock available.
                                </td>
                            </tr>
                        </tbody>
                    </ng-container>
                </table>

                <ng-template #livestockModal class="rounded">
                    <div class="livestockModal-header d-flex justify-content-between align-items-center">
                        <h2 class="pt-2" mat-dialog-title>Livestock Detail</h2>
                        <button mat-icon-button (click)="closeModal()"><mat-icon>close</mat-icon></button>
                    </div>
                    <mat-dialog-content>
                        <div class="row text-center">
                            <div class="col-md-4 mb-3">
                                <img [src]="selectedLivestock.attachment" alt="{{ selectedLivestock.name }}"
                                    class="img-fluid" style="max-height:150px;">
                            </div>
                            <div class="col-md-8 text-start">
                                <p><strong>Name:</strong> {{ selectedLivestock.name }}</p>
                                <p><strong>Species:</strong> {{ selectedLivestock.species }}</p>
                                <p><strong>Breed:</strong> {{ selectedLivestock.breed }}</p>
                                <p><strong>Health Condition:</strong> {{ selectedLivestock.healthCondition }}</p>
                            </div>
                        </div>
                    </mat-dialog-content>
                </ng-template>
            </div>
        </div>

        <div class="d-flex justify-content-center align-items-center mt-3 pagination"
            *ngIf="filteredliveStock.length > 0">
            <button class="btn btn-outline-success btn-sm me-2" (click)="goToPreviousPage()">Prev</button>
            <span>Page {{ currentPage }} of {{ totalPages }}</span>
            <button class="btn btn-outline-success btn-sm ms-2" (click)="goToNextPage()">Next</button>
        </div>
    </div>
</div>